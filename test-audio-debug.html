<!DOCTYPE html>
<html>
<head>
    <title>Audio Debug Test</title>
</head>
<body>
    <h1>VCO Audio Debug Test</h1>
    <button id="test-vco">Test VCO Audio</button>
    <button id="test-trigger">Test Trigger + VCO</button>
    <div id="status"></div>
    
    <script>
        const status = document.getElementById('status');
        
        document.getElementById('test-vco').addEventListener('click', async () => {
            const ctx = new AudioContext();
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            
            osc.frequency.value = 440;
            osc.type = 'sawtooth';
            gain.gain.value = 0.2;
            
            osc.connect(gain);
            gain.connect(ctx.destination);
            osc.start();
            
            status.innerHTML = 'VCO running - should hear continuous 440Hz sawtooth';
            
            setTimeout(() => {
                osc.stop();
                status.innerHTML = 'VCO stopped';
            }, 2000);
        });
        
        document.getElementById('test-trigger').addEventListener('click', async () => {
            const ctx = new AudioContext();
            const osc = ctx.createOscillator();
            const vca = ctx.createGain();
            const gate = ctx.createGain();
            
            // Setup: OSC -> VCA -> destination
            // Gate controls VCA gain
            osc.frequency.value = 440;
            osc.type = 'sawtooth';
            vca.gain.value = 0; // Silent by default
            gate.gain.value = 1;
            
            osc.connect(vca);
            gate.connect(vca.gain); // Gate controls VCA
            vca.connect(ctx.destination);
            osc.start();
            gate.start();
            
            status.innerHTML = 'Trigger test - should hear 1 second pulses';
            
            // Simulate trigger pulses
            let time = ctx.currentTime + 0.1;
            for (let i = 0; i < 4; i++) {
                gate.gain.setValueAtTime(0.2, time);
                gate.gain.setValueAtTime(0, time + 0.5);
                time += 1;
            }
            
            setTimeout(() => {
                osc.stop();
                gate.stop();
                status.innerHTML = 'Trigger test stopped';
            }, 5000);
        });
    </script>
</body>
</html>